{# Plantilla base #}{% extends 'gestion_inventario/layouts/base.html' %}
{# Cargar assets #}{% load static %}
{# Título de la ventana #} {% block titulo_ventana %}Lista de Áreas{% endblock %}
{# Título de la página #} {% block titulo_pagina %}Lista de Áreas{% endblock %}

{% block contenido %}
{# Slider de secciones #}
<div class="slider-container">
    <div class="slider-viewport">
        <div class="slider">

            {% if ubicaciones %}
            {% for ubicacion in ubicaciones  %}
            {% include 'gestion_inventario/partials/_area_card.html' with ubicacion=ubicacion almacen=ubicacion %}
            {% endfor %}
            {% endif %}

        </div>
    </div>

    <button class="slider-btn prev-btn" aria-label="Anterior">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
            <path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"/>
        </svg>
    </button>
    <button class="slider-btn next-btn" aria-label="Siguiente">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
            <path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"/>
        </svg>
    </button>
</div>


{# Dark mode styles for DataTables #}
{% if request.session.dark_mode %}
<style>
    /* DataTables inputs and selects */
    .dark-mode .dataTables_wrapper .dataTables_filter input,
    .dark-mode .dataTables_wrapper .dataTables_length select {
        background: #111318 !important;
        color: #e6edf3 !important;
        border-color: #2b3136 !important;
    }

    /* Pagination and info text */
    .dark-mode .dataTables_wrapper .dataTables_info,
    .dark-mode .dataTables_wrapper .dataTables_paginate {
        color: #cfd8df !important;
    }

    /* Table hover in dark mode */
    .dark-mode table.table.table-hover tbody tr:hover td {
        background-color: rgba(255,255,255,0.02) !important;
    }
</style>
{% endif %}

<div class="container py-4">
    <div class="card shadow-sm color_primario_variante">
        <div class="card-body fondo_secundario color_primario_variante">
            <div class="table-responsive">
                <table id="tablaAreas" class="table table-striped table-hover w-100 fs_normal {% if request.session.dark_mode %}table-dark{% endif %}">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Nombre</th>
                            <th>Compartimentos</th>
                            <th>Existencias</th>
                            <th>Acciones</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% if ubicaciones %}
                        {% for ubicacion in ubicaciones %}
                        <tr>
                            <td>{{ubicacion.id}}</td>
                            <td>{{ubicacion.nombre|title}}</td>
                            <td>{{ubicacion.total_compartimentos}}</td>
                            <td>{{ubicacion.total_existencias}}</td>
                            <td>
                                <a class="btn btn-sm btn-outline-primary fs_normal" href="#">Ver</a>
                                <a class="btn btn-sm btn-outline-secondary fs_normal" href="#">Editar</a>
                                <a class="btn btn-sm btn-outline-danger fs_normal" href="#">Eliminar</a>
                            </td>
                        </tr>
                        {% endfor %}
                        {% endif %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

{# Focused CSS for DataTables when using table-dark #}
{% if request.session.dark_mode %}
<style>
    /* Make DataTables header darker and text lighter */
    table.table-dark thead th {
        background-color: #0d1112 !important;
        color: #e6edf3 !important;
        border-bottom: 1px solid rgba(255,255,255,0.06) !important;
    }

    table.table-dark tbody td {
        color: #cfd8df !important;
    }

    /* Override DataTables length/search controls background */
    .table-dark .dataTables_wrapper .dataTables_filter input,
    .table-dark .dataTables_wrapper .dataTables_length select {
        background: #0b0d0e !important;
        color: #e6edf3 !important;
        border-color: rgba(255,255,255,0.06) !important;
    }

    /* Pagination buttons */
    .dataTables_wrapper .dataTables_paginate .paginate_button {
        color: #cfd8df !important;
    }
</style>
{% endif %}

<script src="{% static 'js/slider.js' %}"></script>

{% block scripts %}
{{ block.super }}
<script>
    // Inicializar DataTables con búsqueda y opciones avanzadas
    document.addEventListener('DOMContentLoaded', function(){
        if(window.jQuery && $.fn.dataTable){
            $('#tablaAreas').DataTable({
                responsive: true,
                pageLength: 25,
                dom: "<'row'<'col-sm-6'l><'col-sm-6'f>>" +
                     "<'row'<'col-sm-12'tr>>" +
                     "<'row'<'col-sm-5'i><'col-sm-7'p>>",
                language: {
                    url: 'https://cdn.datatables.net/plug-ins/1.13.6/i18n/es-ES.json'
                },
            });
        }
    });
</script>
{% endblock %}
{% endblock %}