{% extends 'portal/layouts/base.html' %}
{% load static %}
{% block titulo_ventana %}Establecer Nueva Contraseña{% endblock %}
{% block modulo %}Bomberil{% endblock %}

{% block contenido %}

<style>
  /* Estilo para los mensajes de ayuda de la contraseña */
  .password-help-text ul {
    list-style-type: none;
    padding-left: 0;
    font-size: 0.875em;
  }
</style>

  <div class="col-xl-4 col-lg-6 col-md-8 col-sm-12">
    <div class="card shadow-sm border-0 rounded-lg">
      <div class="card-body p-5">

        {% if validlink %}
          <h2 class="card-title text-center mb-4 fs_grande">Establece tu nueva contraseña</h2>
          <form method="post" class="fs_normal">
            {% csrf_token %}
            
             {% if form.non_field_errors %}
              <div class="alert alert-danger" role="alert">
                {% for error in form.non_field_errors %}
                  {{ error }}
                {% endfor %}
              </div>
            {% endif %}


            {% for field in form %}
              <div class="mb-3">
                <label for="{{ field.id_for_label }}" class="form-label"><strong>{{ field.label }}</strong></label>
                
                <input 
                  type="{{ field.field.widget.input_type }}" 
                  name="{{ field.name }}" 
                  id="{{ field.id_for_label }}" 
                  class="form-control {% if field.errors %}is-invalid{% endif %} fs_normal" 
                  required
                >

                {% for error in field.errors %}
                  <div class="invalid-feedback fs_normal">
                    {{ error }}
                  </div>
                {% endfor %}

                {% if field.help_text %}
                  <div class="form-text text-muted mt-2 password-help-text fs_normal">
                    {{ field.help_text|safe }}
                  </div>
                {% endif %}
              </div>
            {% endfor %}
            

            <div class="d-grid mt-4">
              <button type="submit" class="btn btn-primary btn-lg fs_normal">Cambiar mi contraseña</button>
            </div>
          </form>

        {% else %}
          <div class="text-center">
            <h2 class="card-title text-danger mb-3 fs_grande">Enlace Inválido</h2>
            <p class="text-muted fs_normal">
              El enlace para restablecer la contraseña no es válido. Es posible que ya haya sido utilizado o que haya expirado.
            </p>
            <hr>
            <a href="{% url 'acceso:password_reset' %}" class="btn btn-link fs_normal">Solicitar un nuevo enlace</a>
          </div>
        {% endif %}

      </div>
    </div>
  </div>

{% endblock %}