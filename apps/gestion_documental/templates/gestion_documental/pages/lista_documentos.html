{# Plantilla base #}{% extends 'gestion_documental/layouts/base.html' %}
{# Cargar assets #}{% load static %}
{# Título de la ventana #} {% block titulo_ventana %}Archivo Histórico{% endblock %}
{# Título de la página #} {% block titulo_pagina %}Archivo Histórico{% endblock %}

{% block contenido %}
<div class="container-fluid mt-4"> 
    <div class="panel">
        <div class="panel-header">
            <h1 class="titulo-pagina">
                <i class="fas fa-folder-open" style="margin-right: 10px; color: #D72600;"></i>
                Archivo Histórico: {{ estacion_usuario.nombre | default:"Compañía" }}
            </h1>
            <a href="{% url 'gestion_documental:ruta_subir_documento' %}" class="btn btn-principal">
                <i class="fas fa-cloud-upload-alt"></i> Subir Documento
            </a>
        </div>

        <div class="panel-body">
            
            <table class="data-table styled-table">
                <thead>
                    <tr>
                        <th style="width: 40%;">Documento</th>
                        <th style="width: 20%;">Tipo</th>
                        <th style="width: 15%;">Fecha Origen</th>
                        <th style="width: 15%;">Subido por</th>
                        <th style="width: 10%; text-align: center;">Acciones</th>
                    </tr>
                </thead>
                <tbody>
                    {% for doc in documentos %}
                    <tr>
                        <td>
                            <span class="doc-title">{{ doc.titulo }}</span>
                            <p class="doc-desc">
                                {{ doc.descripcion|truncatewords:20|default:"Sin descripción disponible." }}
                            </p>
                        </td>
                        <td>
                            <span class="badge-type">{{ doc.tipo_documento.nombre }}</span>
                        </td>
                        <td>
                            <div style="display: flex; align-items: center; gap: 5px; color: #555;">
                                <i class="far fa-calendar-alt"></i>
                                {{ doc.fecha_documento | date:"d/m/Y" }}
                            </div>
                        </td>
                        <td>
                            <div style="font-size: 0.9rem;">
                                <i class="fas fa-user-circle" style="color: #ccc; margin-right: 4px;"></i>
                                {{ doc.usuario_registra.get_full_name | default:"Sistema" }}
                            </div>
                        </td>
                        <td style="text-align: center;">
                            <a href="{{ doc.archivo.url }}" class="btn btn-view btn-sm" target="_blank" title="Ver / Descargar PDF">
                                <i class="fas fa-eye"></i> Ver
                            </a>
                        </td>
                    </tr>
                    {% empty %}
                    <tr>
                        <td colspan="5">
                            <div class="empty-state">
                                <i class="fas fa-file-archive"></i>
                                <h3>No hay documentos registrados</h3>
                                <p>Aún no se han digitalizado documentos para esta estación.</p>
                            </div>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>
{% endblock %}